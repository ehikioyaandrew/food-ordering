<!-- POS System Layout -->
<div class="h-screen flex bg-gray-50 dark:bg-dark-bg overflow-hidden">
  <!-- Sidebar Navigation -->
  <nav class="w-64 bg-white dark:bg-dark-bg-card shadow-lg flex flex-col">
    <!-- Logo/Brand -->
    <div class="p-6 border-b border-gray-200 dark:border-dark-border">
      <div class="flex items-center gap-3">
        <div
          class="w-10 h-10 bg-food-orange rounded-xl flex items-center justify-center"
        >
          <svg
            class="w-6 h-6 text-white"
            fill="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"
            />
          </svg>
        </div>
        <div>
          <h1 class="text-xl font-bold text-gray-900 dark:text-white">
            RestaurantPOS
          </h1>
          <p class="text-sm text-gray-500 dark:text-gray-400">Point of Sale</p>
        </div>
      </div>
    </div>

    <!-- Navigation Links -->
    <div class="flex-1 py-6 overflow-y-auto">
      <div class="px-4 space-y-2">
        <a
          routerLink="/"
          routerLinkActive="bg-food-orange text-white"
          [routerLinkActiveOptions]="{ exact: true }"
          class="flex items-center gap-3 px-4 py-3 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl font-medium transition-colors"
        >
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M19 7h-3V6a4 4 0 0 0-8 0v1H5a1 1 0 0 0-1 1v11a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V8a1 1 0 0 0-1-1zM10 6a2 2 0 0 1 4 0v1h-4V6zm8 13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V9h2v1a1 1 0 0 0 2 0V9h4v1a1 1 0 0 0 2 0V9h2v10z"
            />
          </svg>
          New Order
        </a>

        <a
          href="#"
          class="flex items-center gap-3 px-4 py-3 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl font-medium transition-colors"
        >
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"
            />
          </svg>
          Tables
        </a>

        <a
          routerLink="/orders"
          routerLinkActive="bg-food-orange text-white"
          class="flex items-center gap-3 px-4 py-3 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl font-medium transition-colors"
        >
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"
            />
          </svg>
          Orders
        </a>

        <a
          routerLink="/reports"
          routerLinkActive="bg-food-orange text-white"
          class="flex items-center gap-3 px-4 py-3 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl font-medium transition-colors"
        >
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          Reports
        </a>
      </div>
    </div>

    <!-- User Info -->
    <div class="p-4 border-t border-gray-200 dark:border-dark-border">
      <div class="flex items-center gap-3">
        <div
          class="w-10 h-10 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center"
        >
          <svg
            class="w-6 h-6 text-gray-600 dark:text-gray-300"
            fill="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
            />
          </svg>
        </div>
        <div class="flex-1">
          <p class="text-sm font-medium text-gray-900 dark:text-white">
            Sarah Johnson
          </p>
          <p class="text-xs text-gray-500 dark:text-gray-400">
            Cashier • Shift: 9AM-5PM
          </p>
        </div>
        <button
          class="p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200"
        >
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M16 17v-3H9v-4h7V7l5 5-5 5M14 2a2 2 0 012 2v2h-2V4H5v16h9v-2h2v2a2 2 0 01-2 2H5a2 2 0 01-2-2V4a2 2 0 012-2h9z"
            />
          </svg>
        </button>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="flex-1 flex flex-col min-h-0">
    <!-- Header -->
    <header
      class="bg-white dark:bg-dark-bg-card shadow-sm border-b border-gray-200 dark:border-dark-border px-6 py-4 flex-shrink-0"
    >
      <div class="flex items-center justify-between">
        <div>
          <h2 class="text-2xl font-bold text-gray-900 dark:text-white">
            <span
              *ngIf="
                !router.url.includes('/orders') &&
                !router.url.includes('/reports')
              "
              >New Order</span
            >
            <span *ngIf="router.url.includes('/orders')"
              >Orders Management</span
            >
            <span *ngIf="router.url.includes('/reports')"
              >Reports & Analytics</span
            >
          </h2>
          <p class="text-gray-600 dark:text-gray-300">
            <span
              *ngIf="
                !router.url.includes('/orders') &&
                !router.url.includes('/reports')
              "
              >Table #5 • Dine In</span
            >
            <span *ngIf="router.url.includes('/orders')"
              >View and manage order history</span
            >
            <span *ngIf="router.url.includes('/reports')"
              >Sales performance and business insights</span
            >
          </p>
        </div>

        <div class="flex items-center gap-4">
          <!-- Dark Mode Toggle -->
          <button
            (click)="toggleDarkMode()"
            class="p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"
          >
            <svg
              *ngIf="!isDarkMode"
              class="w-5 h-5"
              fill="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                d="M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.166a.75.75 0 00-1.06-1.06l-1.591 1.59a.75.75 0 101.06 1.061l1.591-1.59zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.834 18.894a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 10-1.061 1.06l1.59 1.591zM12 18a.75.75 0 01.75.75V21a.75.75 0 01-1.5 0v-2.25A.75.75 0 0112 18zM7.758 17.303a.75.75 0 00-1.061-1.06l-1.591 1.59a.75.75 0 001.06 1.061l1.591-1.59zM6 12a.75.75 0 01-.75.75H3a.75.75 0 010-1.5h2.25A.75.75 0 016 12zM6.697 7.757a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 00-1.061 1.06l1.59 1.591z"
              />
            </svg>
            <svg
              *ngIf="isDarkMode"
              class="w-5 h-5"
              fill="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                d="M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.98 10.503 10.503 0 01-9.694 6.46c-5.799 0-10.5-4.701-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 01.818.162z"
              />
            </svg>
          </button>

          <!-- Current Time -->
          <div class="text-right">
            <p class="text-sm font-medium text-gray-900 dark:text-white">
              {{ currentTime | date : "shortTime" }}
            </p>
            <p class="text-xs text-gray-500 dark:text-gray-400">
              {{ currentTime | date : "mediumDate" }}
            </p>
          </div>
        </div>
      </div>
    </header>

    <!-- POS Content Area -->
    <div class="flex-1 flex min-h-0">
      <!-- Menu/Products Section -->
      <section class="flex-1 p-6 overflow-y-auto">
        <router-outlet></router-outlet>
      </section>

      <!-- Order Cart Section - Only show on New Order page -->
      <aside
        *ngIf="
          !router.url.includes('/orders') && !router.url.includes('/reports')
        "
        class="w-96 bg-white dark:bg-dark-bg-card border-l border-gray-200 dark:border-dark-border flex flex-col"
      >
        <div class="p-6 flex-1 flex flex-col min-h-0">
          <h3
            class="text-lg font-bold text-gray-900 dark:text-white mb-4 flex-shrink-0"
          >
            Current Order
          </h3>

          <!-- Order Items -->
          <div class="flex-1 space-y-3 overflow-y-auto min-h-0">
            <div
              *ngFor="let item of currentOrderItems"
              class="p-3 bg-gray-50 dark:bg-gray-700 rounded-xl"
            >
              <div class="flex items-center justify-between mb-2">
                <h4 class="font-medium text-gray-900 dark:text-white">
                  {{ item.name }}
                </h4>
                <span class="text-food-orange font-bold">{{
                  formatPrice(item.price)
                }}</span>
              </div>
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-2">
                  <button
                    (click)="decreaseQuantity(item.id)"
                    class="w-8 h-8 bg-white dark:bg-gray-600 rounded-lg flex items-center justify-center hover:bg-gray-100 dark:hover:bg-gray-500 transition-colors"
                  >
                    <svg
                      class="w-4 h-4"
                      fill="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path d="M19 13H5v-2h14v2z" />
                    </svg>
                  </button>
                  <span class="w-8 text-center font-medium">{{
                    item.quantity
                  }}</span>
                  <button
                    (click)="increaseQuantity(item.id)"
                    class="w-8 h-8 bg-food-orange text-white rounded-lg flex items-center justify-center hover:bg-food-orange-dark transition-colors"
                  >
                    <svg
                      class="w-4 h-4"
                      fill="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" />
                    </svg>
                  </button>
                </div>
                <button
                  (click)="removeItem(item.id)"
                  class="text-red-500 hover:text-red-700 transition-colors"
                >
                  <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                    <path
                      d="M9 11H7v6h2v-6zm4 0h-2v6h2v-6zm4 0h-2v6h2v-6zm2-7h-3V2a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v2H5a1 1 0 0 0 0 2h1v12a3 3 0 0 0 3 3h6a3 3 0 0 0 3-3V6h1a1 1 0 0 0 0-2zM10 3h4v1h-4V3zm8 15a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V6h10v12z"
                    />
                  </svg>
                </button>
              </div>
            </div>

            <!-- Empty state when no items -->
            <div
              *ngIf="currentOrderItems.length === 0"
              class="text-center py-8"
            >
              <svg
                class="w-16 h-16 text-gray-400 dark:text-gray-500 mx-auto mb-4"
                fill="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  d="M7 4V2C7 1.45 7.45 1 8 1H16C16.55 1 17 1.45 17 2V4H20C20.55 4 21 4.45 21 5S20.55 6 20 6H19V19C19 20.1 18.1 21 17 21H7C5.9 21 5 20.1 5 19V6H4C3.45 6 3 5.55 3 5S3.45 4 4 4H7ZM9 3V4H15V3H9ZM7 6V19H17V6H7Z"
                />
              </svg>
              <p class="text-gray-500 dark:text-gray-400">
                No items in current order
              </p>
              <p class="text-sm text-gray-400 dark:text-gray-500">
                Add items from the menu to get started
              </p>
            </div>
          </div>

          <!-- Order Summary -->
          <div
            class="mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-xl flex-shrink-0"
          >
            <div class="space-y-2 mb-4">
              <div class="flex justify-between">
                <span class="text-gray-600 dark:text-gray-300">Subtotal</span>
                <span class="font-medium">{{ formatPrice(subtotal) }}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600 dark:text-gray-300">Tax (8%)</span>
                <span class="font-medium">{{ formatPrice(tax) }}</span>
              </div>
              <div class="border-t pt-2 flex justify-between text-lg font-bold">
                <span>Total</span>
                <span class="text-food-orange">{{ formatPrice(total) }}</span>
              </div>
            </div>

            <button
              [disabled]="currentOrderItems.length === 0"
              (click)="openPaymentModal()"
              class="w-full pos-button-primary pos-touch-button text-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed"
            >
              <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path
                  d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"
                />
              </svg>
              Process Payment
            </button>
          </div>
        </div>
      </aside>
    </div>
  </main>
</div>

<!-- Payment Modal -->
<app-payment-modal
  [isOpen]="isPaymentModalOpen"
  [cartItems]="currentOrderItems"
  [subtotal]="subtotal"
  [tax]="tax"
  [total]="total"
  [totalItemsCount]="totalItemsCount"
  (close)="closePaymentModal()"
  (paymentComplete)="onPaymentComplete($event)"
></app-payment-modal>
